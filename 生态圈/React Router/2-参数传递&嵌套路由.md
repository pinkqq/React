## é€šè¿‡ URL ä¼ é€’å‚æ•°

é€šè¿‡ URL ä¼ é€’å‚æ•°æ˜¯å¾ˆå¸¸è§çš„éœ€æ±‚ï¼Œæ¯”å¦‚æ˜¾ç¤ºæ–‡ç« /å•†å“çš„ IDã€‚ æ¨èå°†å‚æ•°ä½œä¸ºè·¯å¾„çš„ä¸€éƒ¨åˆ†ï¼ˆè€Œä¸æ˜¯æŸ¥è¯¢å‚æ•°ï¼‰ï¼Œè¿™æ ·åšå¯¹æœç´¢å¼•æ“æ›´å‹å¥½ã€æ›´æœ‰è¯­ä¹‰ã€‚

### ä¸€ã€å¦‚ä½•é€šè¿‡ URL ä¼ é€’å‚æ•°

æ¼”ç¤ºä¸€ä¸ªä¼ é€’ articleId çš„ä¾‹å­ ğŸŒ°

```jsx
function App() {
  return (
    <Router>
      <nav>
        <ul>
          <li>
            <Link to="/article/1">aritcle 1</Link>
          </li>
          <li>
            <Link to="/article/2">aritcle 2</Link>
          </li>
          <li>
            <Link to="/article/3">aritcle 3</Link>
          </li>
        </ul>
      </nav>
      <div class="page-container">
        <Route path="/article/:id" component={Article}></Route>
      </div>
    </Router>
  );
}
```

### äºŒã€å¦‚ä½•è·å–å‚æ•°

å¯¹äº `React Router` render çš„ç»„ä»¶é€šè¿‡é«˜é˜¶ç»„ä»¶çš„æ–¹å¼ï¼Œä¼šä¼ é€’ä¸€ä¸ª `match` çš„å±æ€§ï¼Œåœ¨ `match.props` ä¸­å¯ä»¥è®¿é—®åˆ°ä¼ é€’çš„å‚æ•°ã€‚

- Hook - `useParams`ï¼ŒReact Router v5.1 æ–°å¢

```jsx
import { useParams } from "react-router-dom";

// æ³¨æ„ï¼šè¿™æ—¶çš„ç»„ä»¶æ˜¯è¢«åŒ…è£¹åœ¨ <Route> é‡Œ
<Route path="/blog/:slug">
  <BlogPost />
</Route>;

function BlogPost() {
  let { slug } = useParams();
  return <div>Now showing post {slug}</div>;
}
```

- å‡½æ•°ç»„ä»¶é€šè¿‡ `({ match }) => ()` è·å¾—å‚æ•°

```jsx
function Article({ match }) {
  return <div> {match.params.id} </div>;
}
```

- ç±»ç»„ä»¶é€šè¿‡ `this.props.match`

```jsx
class Article extends React.Component {
  render() {
    const { match } = this.props;
    return <div>{match.params.id}</div>;
  }
}
```

å¦‚æœè¦ä½¿ç”¨ match çš„è¯ï¼Œç»„ä»¶å¿…é¡»å†™åœ¨ component ä¸­ï¼ˆ`<Route component={Component} />`ï¼‰ã€‚

### ä¸‰ã€ç”¨æ­£åˆ™è¡¨è¾¾å¼åšè·¯ç”±çš„æ¨¡ç³ŠåŒ¹é…

[path-to-regexp](https://github.com/pillarjs/path-to-regexp) æ˜¯ä¸€ä¸ªå°†å­—ç¬¦ä¸²è·¯å¾„è½¬æ¢ä¸ºæ­£åˆ™è¡¨è¾¾å¼çš„çš„å·¥å…·åº“ï¼ŒReact Router å°±ç”¨å®ƒæ¥å¤„ç† url ä¸­åœ°å€ä¸å‚æ•°ã€‚

```js
const { pathToRegexp } = require("path-to-regexp");
```

#### ?ï¼š åŒ¹é… 0 æ¬¡æˆ– 1 æ¬¡

```js
const regexp = pathToRegexp("/:foo/:bar?");
// keys = [{ name: 'foo', ... }, { name: 'bar', prefix: '/', modifier: '?' }]

regexp.exec("/test");
//=> [ '/test', 'test', undefined, index: 0, input: '/test', groups: undefined ]

regexp.exec("/test/route");
//=> [ '/test/route', 'test', 'route', index: 0, input: '/test/route', groups: undefined ]
```

#### \*ï¼šåŒ¹é… 0 æ¬¡æˆ–å¤šæ¬¡

```js
const regexp = pathToRegexp("/:foo*");
// keys = [{ name: 'foo', prefix: '/', modifier: '*' }]

regexp.exec("/");
//=> [ '/', undefined, index: 0, input: '/', groups: undefined ]

regexp.exec("/bar/baz");
//=> [ '/bar/baz', 'bar/baz', index: 0, input: '/bar/baz', groups: undefined ]
```

#### +ï¼šåŒ¹é…ä¸€æ¬¡æˆ–å¤šæ¬¡

```js
const regexp = pathToRegexp("/:foo+");
// keys = [{ name: 'foo', prefix: '/', modifier: '+' }]

regexp.exec("/");
//=> null

regexp.exec("/bar/baz");
//=> [ '/bar/baz','bar/baz', index: 0, input: '/bar/baz', groups: undefined ]
```

#### è‡ªå®šä¹‰åŒ¹é…

é€šè¿‡æ‹¬å·åŒ…è£¹ä¸€ä¸ªè‡ªå®šä¹‰çš„æ­£åˆ™ã€‚

```js
const regexpNumbers = pathToRegexp("/icon-:foo(\\d+).png");
// keys = [{ name: 'foo', ... }]

regexpNumbers.exec("/icon-123.png");
//=> ['/icon-123.png', '123']

regexpNumbers.exec("/icon-abc.png");
//=> null

const regexpWord = pathToRegexp("/(user|u)");
// keys = [{ name: 0, ... }]

regexpWord.exec("/u");
//=> ['/u', 'u']

regexpWord.exec("/users");
//=> null
```

**æ³¨æ„ï¼š** è¿™é‡Œçš„åŒ¹é…æ•°å­— `\\d+` å’Œæ­£åˆ™è¡¨è¾¾å¼ `\d+` ä¸åŒï¼ŒReact Router ä¸­é€‰æ‹© `\d+`ã€‚

### å››ã€ä½•æ—¶ä½¿ç”¨ URL ä¼ é€’å‚æ•°

**é¡µé¢çŠ¶æ€å°½é‡ä½¿ç”¨ URL å‚æ•°å®šä¹‰ï¼Œæ‰©å±•æ€§æ›´å¥½ã€‚**

æ¯”å¦‚ä¸€ä¸ªè€ƒå‹¤ç³»ç»Ÿé‡Œçš„è€ƒå‹¤ä¿¡æ¯é¡µé¢ï¼ŒæŸ¥è¯¢çš„æœˆä»½ä¿¡æ¯æ˜¯å¦è¦æ”¾å…¥ URL ä¸­ï¼Ÿè€ƒè™‘åˆ°å¯èƒ½éœ€è¦è®¿é—®ã€ŒæŒ‡å®šæœˆä»½ã€çš„è€ƒå‹¤ä¿¡æ¯ï¼Œæ‰€ä»¥å°†æœˆä»½ä¿¡æ¯æ”¾ä»» URL å‚æ•°ä¸­æ›´åˆé€‚ã€‚

![router-app.png](https://p3-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/781bd2e7038545779fefc51843eb36d4~tplv-k3u1fbpfcp-watermark.image)

## åµŒå¥—è·¯ç”±

åµŒå¥—è·¯ç”±æ˜¯å‰ç«¯ç‰¹æœ‰çš„æ¦‚å¿µï¼š

- æ¯ä¸ª React ç»„ä»¶éƒ½å¯ä»¥æ˜¯ä¸€ä¸ªå®¹å™¨ç»„ä»¶
- React Router çš„å£°æ˜å¼è¯­æ³•å¯ä»¥æ–¹ä¾¿çš„å®šä¹‰åµŒå¥—è·¯ç”±

![æœªå‘½åæ–‡ä»¶ (4).jpg](https://p6-juejin.byteimg.com/tos-cn-i-k3u1fbpfcp/e58b49cba4d74d399dd10ea0b8018803~tplv-k3u1fbpfcp-watermark.image)

**ç¬¬ä¸€å±‚è·¯ç”±**å°±æ˜¯å¸¸è§„å†™æ³•ï¼š

```jsx
export default function App() {
  return (
    <Router>
      <div>
        <ul>
          <li>
            <NavLink exact to="/">
              Home
            </NavLink>
          </li>
          <li>
            <NavLink to="/about">About</NavLink>
          </li>
          <li>
            <NavLink to="/topics">Topics</NavLink>
          </li>
        </ul>

        <Switch>
          <Route exact path="/">
            <Home />
          </Route>
          <Route path="/about">
            <About />
          </Route>
          <Route path="/topics">
            <Topics />
          </Route>
        </Switch>
      </div>
    </Router>
  );
}

function Home() {
  return <h2>Home</h2>;
}

function About() {
  return <h2>About</h2>;
}
```

**Topic ç»„ä»¶ï¼š**

```jsx
function Topics() {
  return (
    <div>
      <h2>Topics</h2>

      <ul>
        <li>
          <NavLink to="/topics/components">Components</NavLink>
        </li>
        <li>
          <NavLink to="/topics/props-v-state">Props v. State</NavLink>
        </li>
      </ul>
      <Switch>
        <Route path="/topics/:topicId">
          <Topic />
        </Route>
        <Route path="/topics">
          <h3>Please select a topic.</h3>
        </Route>
      </Switch>
    </div>
  );
}
```

å¯ä»¥çœ‹åˆ°åµŒå¥—çš„ç¬¬äºŒå±‚è·¯ç”±ä¹Ÿæ˜¯å¸¸è§„æ“ä½œï¼Œè¿™é‡Œåˆ©ç”¨äº† `<Route>` çš„å…±å­˜å±æ€§ï¼Œå¤šæ¬¡åŒ¹é…åŒä¸€ä¸ªè·¯å¾„æ¸²æŸ“ä¸åŒçš„ç»„ä»¶ã€‚

ç¬¬ä¸€å±‚è·¯ç”±åŒ¹é…éƒ¨åˆ†ä¹Ÿå¯ä»¥ç”¨ `useRouteMatch` æ¥å®Œæˆï¼š

> **useRouteMatch**ï¼šå°è¯•ä»¥ä¸<Route>ç›¸åŒçš„æ–¹å¼åŒ¹é…å½“å‰ URLã€‚ React-Router v5.1 æ–°å¸¦æ¥çš„ Hookã€‚

```jsx
import { useRouteMatch } from "react-router-dom";

function Topics() {
  let match = useRouteMatch();
  /*
    {
      isExact: false,
      params: {},
      path: "/topics",
      url: "/topics",
    };
  */
  return (
    <div>
      <h2>Topics</h2>

      <ul>
        <li>
          <NavLink to={`${match.url}/components`}>Components</NavLink>
        </li>
        <li>
          <NavLink to={`${match.url}/props-v-state`}>Props v. State</NavLink>
        </li>
      </ul>

      <Switch>
        <Route path={`${match.path}/:topicId`}>
          <Topic />
        </Route>
        <Route path={match.path}>
          <h3>Please select a topic.</h3>
        </Route>
      </Switch>
    </div>
  );
}
```

**Topic ç»„ä»¶**

```jsx
import { useParams } from "react-router-dom";

function Topic() {
  const { topicId } = useParams();
  return <h3>Requested topic ID: {topicId}</h3>;
}
```

## å‚è€ƒèµ„æ–™

- path-to-regexp ä»‹ç»ï¼šhttps://wangwl.net/static/pages/npm_pathtoregexp.html
- react-router v4 è·¯ç”±è§„åˆ™è§£æï¼šhttps://juejin.cn/post/6844903710850547725
- react-router ç©¶ç«Ÿæ€ä¹ˆç©å„¿ï¼Ÿï¼šhttps://www.jianshu.com/p/f7bd56878401
- React-Router çš„ Hooksï¼šhttps://segmentfault.com/a/1190000022445986
- React Router V5 ä½¿ç”¨æ€»ç»“ï¼š https://juejin.cn/post/6844904019714899976#heading-6
